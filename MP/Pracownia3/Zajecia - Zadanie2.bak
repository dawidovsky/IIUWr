#lang racket

(define (dist x y)
  (abs (- x y)))

(define (average x y)
  (/ (+ x y) 2))

(define (square x)
  (* x x))

(define (sqrt x)
  (define (improve approx)
    (average (/ x approx) approx))
  (define (good-enough? approx)
    (< (dist x (square approx)) 0.00001))
  (define (iter approx)
    (cond
      [(good-enough? approx) approx]
      [else                  (iter (improve approx))]))
  
  (iter 1.0))

(define (point-x x) (car x))
(define (point-y x) (cdr x))
(define (make-point x y) (cons x y))
(define (point? x)
  (if (pair? x)
      #t
      #f))

(define point1 (make-point 1 5))
(define point2 (make-point 5 5))
(define point3 (make-point 1 3))
(define point4 (make-point 2 5))

(define (display-point p)
  (display "(")
  (display (point-x p))
  (display ", ")
  (display (point-y p))
  (display ")"))

(define (vect-begin vec) (car vec))
(define (vect-end vec) (cdr vec))
(define (make-vect x y) (cons x y))
(define (vect? x)
  (if (and (pair? x) (pair? (car x)) (pair? (cdr x)))
      #t
      #f))

(define vec1 (make-vect point1 point2))
(define vec2 (make-vect point3 point4))

(define (display-vect v)
  (display "[")
  (display-point (vect-begin v))
  (display ", ")
  (display-point (vect-end v))
  (display "]"))

(define (vect-length vec)
  (sqrt (+ (square (- (car (cdr vec)) (car (car vec))))
           (square(- (cdr (cdr vec)) (cdr (car vec)))))))

(define (vect-scale vec k)
  (make-vect (vect-begin vec)
             (make-point (* (car (vect-end vec)) k)
                         (* (cdr (vect-end vec)) k))))

(define (vect-translate vec p)
  (make-vect p (make-point (+ (car p) (- (car (cdr vec)) (car (car vec))))
                           (+ (cdr p) (- (cdr (cdr vec)) (cdr (car vec)))))))